function extend(t,o){for(var e in o)t[e]=o[e];return t}var FontCssProperty=function(){this.empty=!0,this.shorthand=!1,this.properties={}};FontCssProperty.TAGS_FOR_PRESENTATION={U:{textDecoration:"underline"},B:{fontWeight:"bold"},STRONG:{fontWeight:"bold"},I:{fontStyle:"italic"},EM:{fontStyle:"italic"},S:{textDecoration:"line-through"},STRIKE:{textDecoration:"line-through"},INS:{textDecoration:"underline"},DEL:{textDecoration:"line-through"},FONT:function(t){var o={};t.face&&(o.fontFamily=t.face),t.color&&(o.color=t.color);var e=["","x-small","small","medium","large","x-large","xx-large"];if(t.size){var r=t.size;o.fontSize=isNaN(r)?r:e[Math.min(Math.max(1,r),6)]}return o}},FontCssProperty.FONT_RELATED_CSS_PROPERTIES={font:"font","font-style":"fontStyle","font-weight":"fontWeight","font-size":"fontSize","font-family":"fontFamily","text-decoration":"textDecoration",color:"color","background-color":"backgroundColor"},FontCssProperty.create=function(t,o){var e=new FontCssProperty,r=FontCssProperty.TAGS_FOR_PRESENTATION[t];if(r){var n="function"==typeof r?r(o):r;for(var i in n)e.setProperty(i,n[i])}var s=o.style;if(s){s=s.replace(/[\w-]+:\s?;/g,"");for(var a=s.split(/; ?|: ?/),f=0;f<a.length-1;f+=2){var l=FontCssProperty.FONT_RELATED_CSS_PROPERTIES[a[f].toLowerCase()];l&&("backgroundColor"!=l||FontCssProperty.TAGS_FOR_PRESENTATION[t]||"SPAN"==t)&&e.setProperty(l,a[f+1])}}return e.getComputedStyles()},FontCssProperty.FONT_CSS_REGEXP=/(.*?)(\w+)(\/\w+)?\s+(['"]?[\w\uac00-\ud7a3]+['"]?)$/,FontCssProperty.NORMAL_VALUE="normal",FontCssProperty.prototype.isEmpty=function(){return this.empty},FontCssProperty.prototype.setProperty=function(t,o){if(/^font$/i.test(t)){var e=this.fromShorthand(o);e&&(this.shorthand=!0,extend(this.properties,this.fromShorthand(o)))}else this.properties[t]=o;this.empty=!1},FontCssProperty.prototype.getComputedStyles=function(){return this.shorthand?this.toShorthand():extend({},this.properties)},FontCssProperty.prototype.fromShorthand=function(t){var o=t.indexOf(","),e="";o>0&&(e=t.substring(o),t=t.substring(0,o));var r=t.match(FontCssProperty.FONT_CSS_REGEXP);if(r===_NULL)return _NULL;var n=FontCssProperty.NORMAL_VALUE,i={fontSize:r[2],lineHeight:(r[3]||n).replace("/",""),fontFamily:r[4]+e,fontWeight:n,fontStyle:n,fontVariant:n},s=r[1];return/bold|700/i.test(s)&&(i.fontWeight="bold"),/italic/i.test(s)&&(i.fontStyle="italic"),/small-caps/i.test(s)&&(i.fontVarient="small-caps"),i},FontCssProperty.prototype.toShorthand=function(){var t=extend({},this.properties),o=FontCssProperty.NORMAL_VALUE,e=[];["fontWeight","fontStyle","fontVarient"].each(function(r){t[r]!=o&&e.push(t[r])}),t.lineHeight!=o?e.push(t.fontSize+"/"+t.lineHeight):e.push(t.fontSize),e.push(t.fontFamily),["fontWeight","fontStyle","fontVarient","fontSize","lineHeight","fontFamily"].each(function(o){delete t[o]});var r={font:e.join(" ")};return r=extend(r,t)};