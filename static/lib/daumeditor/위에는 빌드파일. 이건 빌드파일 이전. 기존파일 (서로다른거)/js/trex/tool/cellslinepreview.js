Trex.MarkupTemplate.add("cellsline.preview",['<table width="#{width}" cellPadding="0" style="line-height:0"><tbody><tr>','<td valign="center" height="#{height}">','<div style="border-bottom:#{value};width:#{width}px;height:2px;overflow:hidden;"></div>',"</td>","</tr></tbody></table>"].join("")),TrexConfig.addTool("cellslinepreview",{sync:_FALSE,status:_TRUE,options:[{label:Trex.MarkupTemplate.get("cellsline.preview").evaluate({value:"1pt solid #ccc",width:70,height:14}),title:"1pt solid #ccc",data:"#ccc 1 solid"},{label:Trex.MarkupTemplate.get("cellsline.preview").evaluate({value:"2pt solid #c54",width:70,height:14}),title:"2pt solid #c54",data:"#c54 2 solid"},{label:Trex.MarkupTemplate.get("cellsline.preview").evaluate({value:"2pt solid #67f",width:70,height:14}),title:"2pt solid #67f",data:"#67f 2 solid"},{label:Trex.MarkupTemplate.get("cellsline.preview").evaluate({value:"3pt solid #000",width:70,height:14}),title:"3pt solid #000",data:"#000 3 solid"},{label:Trex.MarkupTemplate.get("cellsline.preview").evaluate({value:"1pt dashed #d4c",width:70,height:14}),title:"1pt dashed #d4c",data:"#d4c 1 dashed"}]}),Trex.Tool.Cellslinepreview=Trex.Class.create({$const:{__Identity:"cellslinepreview"},$extend:Trex.Tool,oninitialized:function(e){var t=this;this.data={color:"",height:0,type:""},this.weave(new Trex.Button.CellslinepreviewList(this.buttonCfg),new Trex.Menu.Select(this.menuCfg),this.handler),this.toolbar.observeJob(Trex.Ev.__TOOL_CELL_LINE_CHANGE,function(e){t.setData(e),t.refreshPreview()})},setData:function(e){"color"in e&&(this.data.color=e.color),"height"in e&&(this.data.height=e.height),"type"in e&&(this.data.type=e.type)},refreshPreview:function(){var e;e=this.data,text=e.height+"pt "+e.type+" "+e.color,this.setPreview(text)},setPreview:function(e){this.button.elText.innerHTML=Trex.MarkupTemplate.get("cellsline.preview").evaluate({value:e,width:43,height:14})},addBorderHistory:function(e){this.setData(e),this.refreshPreview()},handler:function(e,t){var i=this,l=i.canvas;l.execute(function(t){var i;t.table&&(i=e.split(" "),t.table.setBorderButtons(i[0],i[1],i[2]))})}}),Trex.Button.CellslinepreviewList=Trex.Class.create({$extend:Trex.Button.Select,setText:function(e){this.tool.setPreview(e)}});