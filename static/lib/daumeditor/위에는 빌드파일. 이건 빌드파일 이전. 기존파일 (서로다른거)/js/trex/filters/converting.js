Trex.register("filter > mode change",function(e,n,t,r,g){function p(e){for(var n=[[Trex.__WORD_JOINER_REGEXP,""],[new RegExp("<(\\/?[a-z]+)[^>]*>","gi"),"<$1>"],[new RegExp("\\n\\s*","g"),""],[new RegExp("<head>.*?<\\/head>","gi"),""],[new RegExp("<script>.*?<\\/script>","gi"),""],[new RegExp("<style>.*?<\\/style>","gi"),""],[new RegExp("<!--.*?-->","gi"),""],[new RegExp("<span></span>","gi"),""],[new RegExp("^<p>&nbsp;</p>$","gi"),""],[new RegExp("^<p><br></p>$","gi"),""],[new RegExp("<td>(.+?)<\\/td>","gi"),"\t$1"],[new RegExp("<th>(.+?)<\\/th>","gi")," \t$1"],[new RegExp("<\\/tr>","gi"),""],[new RegExp("<tr>","gi"),"\n"],[new RegExp("<\\?tbody>","gi"),""],[new RegExp("<div>([^<]*)<\\/div>","gi"),"\n$1"],[new RegExp("<p>&nbsp;</p>","gi"),"\n"],[new RegExp("<p><br></p>","gi"),"\n"],[new RegExp("<br>(<\\/p>)","gi"),"$1"],[new RegExp("<h[1-6]>(.+?)<\\/h[1-6]>","gi"),"\n$1\n\n"],[new RegExp("(<p>(.+?)<\\/p>)","gi"),"$1\n"],[new RegExp("<br>\\n","gi"),"\n"],[new RegExp("<br>","gi"),"\n"],[new RegExp("(<ul>|<\\/ul>|<ol>|<\\/ol>|<\\/table>)","gi"),"\n\n"],[new RegExp("(<li>(.+?)<\\/li>)","gi"),"\t$1\n"],[new RegExp("<div><\\/div>\n","gi"),"~"],[new RegExp("<[\\/a-zA-Z!]+>","g"),""],[new RegExp("&nbsp;?","g")," "],[new RegExp("&quot;?","g"),'"'],[new RegExp("&gt;?","g"),">"],[new RegExp("&lt;?","g"),"<"],[new RegExp("&amp;?","g"),"&"],[new RegExp("&copy;?","g"),"(c)"],[new RegExp("&trade;?","g"),"(tm)"],[new RegExp("&#8220;?","g"),'"'],[new RegExp("&#8221;?","g"),'"'],[new RegExp("&#8211;?","g"),"_"],[new RegExp("&#8217;?","g"),"'"],[new RegExp("&#38;?","g"),"&"],[new RegExp("&#169;?","g"),"(c)"],[new RegExp("&#8482;?","g"),"(tm)"],[new RegExp("&#151;?","g"),"--"],[new RegExp("&#039;?","g"),"'"],[new RegExp("&#147;?","g"),'"'],[new RegExp("&#148;?","g"),'"'],[new RegExp("&#149;?","g"),"*"],[new RegExp("&reg;?","g"),"(R]"],[new RegExp("&bull;?","g"),"*"]],t=e,r=0;r<n.length;r++)t=t.replace(n[r][0],n[r][1]);return t}function i(e){try{return e.replace(new RegExp("<br[^>]*>\\n","gi"),"\n")}catch(e){}return e}function u(e){return e!==_NULL&&0!==e.length&&(e=e.replace(/&/g,"&amp;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/</g,"&lt;"),e.lastIndexOf("\n")===e.length-1&&(e=e.substr(0,e.length-1)),e.lastIndexOf("\r")===e.length-1&&(e=e.substr(0,e.length-1)),e=e.replace(/\r\n|\r|\n/g,"<br>\n")),e}function c(e){return e.replace(/<\/(p)><(p[\s>])/gi,"</$1>\n<$2")}function o(e){return e.replace(/<\/(p)>\n+<(p[\s>])/gi,"</$1><$2")}function x(e){if(!($tx.msie&&$tx.msie_docmode<9))return e;if(!r.isWYSIWYG())return e;var n=r.getCurrentPanel().getWindow().location,t=n.protocol+"//"+n.host,g=n.href,p=g.substring(0,g.lastIndexOf("/")+1),i=new RegExp("(href=[\"'])("+t.getRegExp()+"[^\"']*)([\"'])","gi");return e.replace(i,function(e,n,r,i){var u=r.replace(g,"").replace(p,"").replace(t,"");return n+u+i})}var l=e.getDocParser();l.registerFilter("filter/converting",{"text@load":function(e){return p(e)},"source@load":function(e){return e},"html@load":function(e){return e},text4save:function(e){var n;return n=g.canvas.escapeTextModeContents?u(e):e,g.canvas.removeTextModeBr&&(n=i(n)),n},source4save:function(e){return e},html4save:function(e){return x(e)},text2source:function(e){return u(e)},text2html:function(e){return u(e)},source2text:function(e){return p(o(e))},source2html:function(e){return o(e)},html2text:function(e){return p(e)},html2source:function(e){return x(c(e))}})}),Trex.register("filter > non-breaking space",function(e){function n(e){return e.replace(/\u00A0/g," ")}var t=e.getDocParser();t.registerFilter("filter/converting/nonbreakingsapce",{"text@load":function(e){return n(e)},"source@load":function(e){return n(e)},"html@load":function(e){return n(e)},text4save:function(e){return n(e)},source4save:function(e){return n(e)},html4save:function(e){return n(e)},text2html:function(e){return n(e)},source2html:function(e){return n(e)},html2source:function(e){return n(e)}})});