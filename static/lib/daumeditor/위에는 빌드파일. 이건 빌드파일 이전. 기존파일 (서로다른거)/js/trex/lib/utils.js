!function(t){function e(t){var e=TrexConfig.getIconPath(t);return e+""}t.Util={_dispElIds:[],getDispElId:function(){var e;do e="tx_entry_"+(Math.floor(9e4*Math.random())+1e4)+"_";while(t.Util._dispElIds.contains(e));return t.Util._dispElIds.push(e),e},generateKey:function(){return parseInt(1e8*Math.random())},toStyleString:function(t){var e=[];for(var i in t)t[i]&&(e.push(i.replace(/([A-Z])/g,"-$1").toLowerCase()),e.push(":"),e.push(t[i]),e.push(";"));return e.join("")},toAttrString:function(t){var e=[];for(var i in t)t[i]&&e.push(" "+i+'="'+t[i]+'"');return e.join("")},getMatchValue:function(t,e,i){var n;return(n=t.exec(e))!=_NULL?n[i]:_NULL},getAttachmentType:function(t){t=(t||"").toLowerCase();var e=["image/jpg","image/jpeg","image/png","image/tiff","image/gif","image/bmp","image/x-jg","image/ief","image/pict","jpg","bmp","gif","png"];return e.contains(t)?"image":"file"},thumburl:function(t){switch(t=(t||"").toLowerCase()){case"doc":case"docx":return e("#iconpath/pn_word.gif");case"xls":case"xlsx":return e("#iconpath/pn_xls.gif");case"ppt":case"pptx":return e("#iconpath/pn_ppt.gif");case"pdf":return e("#iconpath/pn_pdf.gif");case"txt":return e("#iconpath/pn_txt.gif");case"hwp":return e("#iconpath/pn_hwp.gif");case"zip":case"alz":return e("#iconpath/pn_zip.gif");case"mp3":case"wav":case"ogg":case"wma":case"mp4":case"ape":case"ra":case"ram":return e("#iconpath/pn_mp3.gif");case"avi":case"mpeg":case"wmv":case"asf":return e("#iconpath/pn_movie.gif");case"swf":return e("#iconpath/pn_swf.gif");case"htm":case"html":return e("#iconpath/pn_html.gif");case"jpg":case"gif":case"png":case"bmp":return e("#iconpath/pn_etc.gif");default:return e("#iconpath/pn_etc.gif")}},prevurl:function(t){switch(t=(t||"").toLowerCase()){case"doc":case"docx":return e("#iconpath/p_word_s.gif");case"xls":case"xlsx":return e("#iconpath/p_xls_s.gif");case"ppt":case"pptx":return e("#iconpath/p_ppt_s.gif");case"pdf":return e("#iconpath/p_pdf_s.gif");case"txt":return e("#iconpath/p_txt_s.gif");case"hwp":return e("#iconpath/p_hwp_s.gif");case"zip":case"alz":return e("#iconpath/p_zip_s.gif");case"mp3":case"wav":case"ogg":case"wma":case"mp4":case"ape":case"ra":case"ram":return e("#iconpath/p_mp3_s.gif");case"avi":case"mpeg":case"wmv":case"asf":return e("#iconpath/p_movie_s.gif");case"swf":return e("#iconpath/p_swf_s.gif");case"htm":case"html":return e("#iconpath/p_html_s.gif");case"jpg":return e("#iconpath/p_jpg_s.gif");case"gif":return e("#iconpath/p_gif_s.gif");case"png":case"bmp":return e("#iconpath/p_png_s.gif");default:return e("#iconpath/p_etc_s.gif")}},getMatchedClassName:function(t,e){for(var i=_FALSE,n="",s=0;s<e.length;s++)if(n=e[s],$tx.hasClassName(t,n)){i=n;break}return i},getAllAttributesFromEmbed:function(t){var e={};t=t.replace(/<embed|>/gi,"");try{for(var i,n=/(\w+)=((?:\")[^\"]+(?:\"|$)|(?:')[^']+(?:'|$)|(?:[^\"'][^ \n]+($| |\n)))/gi;(i=n.exec(t))!=_NULL;)e[i[1].trim().toLowerCase()]=i[2].replace(/^(\"|')/i,"").replace(/(\"|')$/i,"").trim()}catch(t){}return e},getAllAttributes:function(t){for(var e,i={},n=/style="(?:\s*|(?:[^"]*(?:;\s*)))width\s*:\s*([0-9]+)px[^"]*"/gi;(e=n.exec(t))!=_NULL;)i.width=e[1];for(n=/style="(?:\s*|(?:[^"]*(?:;\s*)))height\s*:\s*([0-9]+)px[^"]*"/gi;(e=n.exec(t))!=_NULL;)i.height=e[1];for(n=new RegExp('\\s+([a-zA-Z-]+)="([^"]*)"',"g");(e=n.exec(t))!=_NULL;)i[e[1].toLowerCase()]||(i[e[1].toLowerCase()]=e[2]);for(n=new RegExp("\\s+([a-zA-Z-]+)='([^']*)'","g");(e=n.exec(t))!=_NULL;)i[e[1].toLowerCase()]||(i[e[1].toLowerCase()]=e[2]);for(n=new RegExp("\\s+([a-zA-Z-]+)=([^\\s>]*)","g");(e=n.exec(t))!=_NULL;)i[e[1].toLowerCase()]||(i[e[1].toLowerCase()]=e[2]);return i}},t.HtmlCreator={createTableMarkup:function(t,e,i){var n=[];n.push('<table unselectable="on">'),n.push("<tbody>");for(var s,a=i.length,r=0;r<t;r++){n.push("<tr>");for(var c=0;c<e;c++)if(r*e+c<a)if(s=i[r*e+c],s.image){var o=TrexConfig.getIconPath(s.image);n.push('<td class="tx-menu-list-item"><a href="javascript:;"><span class="'+(s.klass||"")+'"><img src="'+o+'" data="'+s.data+'"/></span></a></td>')}else n.push('<td class="tx-menu-list-item"><a href="javascript:;"><span class="'+(s.klass||"")+'">'+s.data+"</span></a></td>");else n.push('<td class="tx-menu-list-item"><a href="javascript:;"><span class="">&nbsp;</span></a></td>');n.push("</tr>")}return n.push("</tbody>"),n.push("</table>"),n.join("\n")}},t.String={escapeQuot:function(t){return t.replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("'","g"),"&#39;")},unescapeQuot:function(t){return t.replace(new RegExp("&quot;","gi"),'"').replace(new RegExp("&#39;","g"),"'")},htmlspecialchars:function(e){return t.String.escapeQuot(e.replace(new RegExp("&","g"),"&amp;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;"))},unHtmlspecialchars:function(e){return t.String.unescapeQuot(e.replace(new RegExp("&amp;","gi"),"&").replace(new RegExp("&lt;","gi"),"<").replace(new RegExp("&gt;","gi"),">"))},parseAttribute:function(t,e){var i,n=new RegExp("(^|\\W)"+e+'="([^"]*)"',"gi"),s=new RegExp("(^|\\W)"+e+"='([^']*)'","gi"),a=new RegExp("(^|\\W)"+e+"=([^\\s>]*)","gi");return(i=n.exec(t))?i[2]:(i=s.exec(t))?i[2]:(i=a.exec(t))?i[2]:""},changeAttribute:function(t,e,i,n){var s=new RegExp("(^|\\W)("+e+'=")'+i+'(")',"gi"),a=new RegExp("(^|\\W)("+e+"=')"+i+"(')","gi"),r=new RegExp("(^|\\W)("+e+"=)"+i,"gi"),c=new RegExp("<([\\w]+\\s*)","gi"),o=_FALSE;return t.search(s)>-1&&(o=_TRUE,t=t.replace(s,"$1$2"+n+"$3")),t.search(a)>-1&&(o=_TRUE,t=t.replace(a,"$1$2"+n+"$3")),t.search(r)>-1&&(o=_TRUE,t=t.replace(r,"$1$2"+n)),o||(t=t.replace(c,"<$1"+e+"="+n+" ")),t}},t.Validator=t.Class.create({initialize:function(){},strip:function(e){return e.stripTags().replace(/&nbsp;/g,"").replace(t.__WORD_JOINER_REGEXP,"").trim()},exists:function(t){return t?""==this.strip(t)&&t.search(/<(img|iframe|object|embed|table|hr|script|TXDB)/i)<0?_FALSE:_TRUE:_FALSE},equals:function(t,e){return t&&e&&t.search(/<(img|iframe|object|embed|table|hr|script|TXDB)/i)<0&&this.strip(t)==this.strip(e)?_TRUE:_FALSE}}),t.Repeater=t.Class.create({initialize:function(t){this.execHandler=t},start:function(t){this.tItv&&this.clear(),this.tItv=_WIN.setInterval(this.onTimer.bind(this),t)},clear:function(){_WIN.clearInterval(this.tItv),this.tItv=_NULL},onTimer:function(){this.execHandler!=_NULL&&this.execHandler()}}),t.Timer=t.Class.create({initialize:function(t){this.execHandler=t},start:function(t){_WIN.setTimeout(this.onTimer.bind(this),t)},onTimer:function(){this.execHandler!=_NULL&&this.execHandler()}}),t.Paging=t.Class.create({$const:{DEFAULT_PAGE_SIZE:5,DEFAULT_BLOCK_SIZE:10},initialize:function(e,i){this.data=e,this.currentpage=i.initPage||1,this.totalrow=i.totalrow||this.getTotalRow(),this.pagesize=i.pagesize||t.Paging.DEFAULT_PAGE_SIZE,this.blocksize=i.blocksize||t.Paging.DEFAULT_PAGE_SIZE,this.totalpage=Math.ceil(this.totalrow/this.pagesize),this.totalblock=Math.ceil(this.totalpage/this.blocksize)},getNextPage:function(){return this.currentpage<this.totalpage?this.currentpage+1:0},getPrevPage:function(){return this.currentpage>1?this.currentpage-1:0},getNextBlock:function(){var t=Math.ceil(this.currentpage/this.blocksize);return t<this.totalblock?t*this.blocksize+1:0},getPrevBlock:function(){var t=Math.ceil(this.currentpage/this.blocksize);return t>1?(t-2)*this.blocksize+1:0},getPageList:function(){for(var t=[],e=Math.ceil(this.currentpage/this.blocksize)-1,i=e*this.blocksize+1,n=Math.min(this.totalpage,i+this.blocksize-1),s=i;s<=n;s++)t.push(s);return t},movePage:function(t){this.currentpage=t||this.currentpage},getOnePageData:function(){for(var t=[],e=(this.currentpage-1)*this.pagesize,i=Math.min(this.currentpage*this.pagesize,this.totalrow),n=e;n<i;n++)t.push(this.data[n]);return t},getTotalRow:function(){return this.data.length}}),t.Slidebar=t.Class.create({initialize:function(t){this.elContext=t.el,this.knobWidth=t.knobWidth,this.isDisabled=_FALSE,this.handler=function(e){this.isDisabled||"function"!=typeof t.handler||t.handler(e)},this.logicObj={interval:t.interval||5,min:t.min||0,max:t.max||100},this.physicObj={min:0,width:t.barSize||100},this.physicObj.max=this.physicObj.width-this.knobWidth,this.physicObj.interval=this.logicObj.interval*this.physicObj.max/this.logicObj.max,this.startPos=0,this.startX=0,this.isDrag=_FALSE,this.result=0;var e=$tom.collect(this.elContext,"dd.tx-slide");$tom.collect(e,"span.tx-slide-min").innerHTML="",$tom.collect(e,"span.tx-slide-max").innerHTML="",this.bindEvent(),this.setKnobPosition(t.defaultValue||t.min||0)},regenerate:function(t){t=parseInt(t*this.physicObj.width/this.logicObj.max),this.setKnobPosition(t)},bindEvent:function(){var t=$tom.collect(this.elContext,"dd.tx-slide"),e=$tom.collect(t,"a.tx-slide-prev"),i=$tom.collect(t,"a.tx-slide-next"),n=$tom.collect(t,"div.tx-slide-bar"),s=this.elKnob=$tom.collect(t,"div.tx-slide-knob");$tx.observe(s,"mousedown",function(t){this.isDrag=_TRUE,this.startPos=this.getKnobPosition(),this.startX=t.clientX,$tx.stop(t)}.bind(this)),$tx.observe(s,"mouseup",function(){this.isDrag=_FALSE}.bind(this)),$tx.observe(this.elContext,"mousemove",function(t){this.isDrag&&(this.setKnobPosition(this.startPos+t.clientX-this.startX),$tx.stop(t),this.handler(this.result))}.bind(this)),$tx.observe(e,"click",function(t){var e=Math.round(this.physicObj.interval)-1,i=this,n=function(){var t=i.getKnobPosition();i.setKnobPosition(t-1),e-- >0?setTimeout(n,10):i.handler(i.result)};n(),$tx.stop(t)}.bind(this)),$tx.observe(i,"click",function(t){var e=Math.round(this.physicObj.interval),i=this,n=function(){var t=i.getKnobPosition();i.setKnobPosition(t+1),--e>0?setTimeout(n,10):i.handler(i.result)};n(),$tx.stop(t)}.bind(this)),$tx.observe(this.elContext,"mouseup",function(){this.isDrag&&(this.isDrag=_FALSE)}.bind(this)),$tx.observe(s,"click",function(t){$tx.stop(t)}.bind(this)),$tx.observe(n,"click",function(t){if(!this.isDrag){var e=t.layerX||t.x;this.setKnobPosition(e-this.knobWidth/2),this.handler(this.result)}}.bind(this))},getKnobPosition:function(){var t=$tx.getStyle(this.elKnob,"left");return t.parsePx()},setKnobPosition:function(t){t=t<this.physicObj.max?t:this.physicObj.max,t=t>this.physicObj.min?t:this.physicObj.min,$tx.setStyle(this.elKnob,{left:t.toPx()}),this.result=Math.round(t*this.logicObj.interval/this.physicObj.interval)},setDisable:function(){this.isDisabled=_TRUE},setEnable:function(){this.isDisabled=_FALSE},getDisabled:function(){return this.isDisabled}}),t.DynamicSizer=t.Class.create({initialize:function(e){this.config=e,this.wrapper=e.el,this.elEventContext=tx.div({className:"tx-dynamic-sizer-context"}),this.currentSize={row:0,col:0},this.dynamicSizingEnabled=_TRUE,e.moveHandler||(e.moveHandler=function(){}),e.clickHandler||(e.clickHandler=function(){}),this.wrapper.appendChild(this.elEventContext),this.previewTable=new t.DynamicSizer.PreviewTable({parentEl:this.elEventContext,mouseOverHandler:this.changeSize.bind(this),mouseClickHandler:this.selectSize.bind(this)})},clear:function(){this.dynamicSizingEnabled=_TRUE,this.changeSize(0,0)},changeSize:function(t,e){this.dynamicSizingEnabled&&(this.currentSize.row=t,this.currentSize.col=e,this._changeSelectionSize(t,e),this.config.moveHandler(t,e))},_changeSelectionSize:function(t,e){this.previewTable.moveSelectionPos(t,e)},toggleDynamicSizing:function(){this.dynamicSizingEnabled=!this.dynamicSizingEnabled,this.dynamicSizingEnabled?this.selection.enableResize():this.selection.disableResize()},selectSize:function(t){this.config.clickHandler(t,this.currentSize)},getCurruentSize:function(){return this.currentSize}}),t.DynamicSizer.PreviewTable=t.Class.create({$const:{DEFAULT_TD_STYLE:{},DEFAULT_TABLE_PROPERTY:{cellpadding:"0",cellspacing:"1"},MAX_SIZE:{COL:10,ROW:10}},initialize:function(e){this.config=e,this.elTable=_NULL,this.elTable=this.generateTable("tx-event"),this.elSelection=tx.div({className:"tx-selection"},this.generateTable("tx-selection"));var i=this.generateTable("tx-panel");this.eventBinding(),e.parentEl.appendChild(this.elTable),e.parentEl.appendChild(this.elSelection),e.parentEl.appendChild(i);var n=$tom.getPosition(this.elTable),s=t.DynamicSizer.PreviewTable.MAX_SIZE;this.cellSize={width:Math.round((n.width-n.x)/s.COL),height:(n.height-n.y)/s.ROW}},generateTable:function(e){for(var i=tx.tbody(),n=t.DynamicSizer.PreviewTable,s=0;s<n.MAX_SIZE.ROW;s++){for(var a=tx.tr(),r=0;r<n.MAX_SIZE.COL;r++){var c=tx.td(tx.div({style:n.DEFAULT_TD_STYLE}));c=this.setCoordToAttr(c,r+1,s+1),a.appendChild(c)}i.appendChild(a)}var o=tx.table(n.DEFAULT_TABLE_PROPERTY);return $tx.addClassName(o,e||""),o.appendChild(i),o},moveSelectionPos:function(t,e){var i=(e*this.cellSize.width).toPx(),n=(t*this.cellSize.height).toPx();$tx.setStyle(this.elSelection,{width:i,height:n})},setCoordToAttr:function(t,e,i){return t.setAttribute("col",e),t.setAttribute("row",i),t},getCoordFromAttr:function(t){return{col:t.getAttribute("col")||0,row:t.getAttribute("row")||0}},eventBinding:function(){this.mouseOverHandler=this.config.mouseOverHandler,this.mouseClickHandler=this.config.mouseClickHandler;var t=this,e=function(e){var i=$tx.element(e)||{},n=(i.tagName||"").toUpperCase();if(i&&"TD"==n){var s=t.getCoordFromAttr(i);t.mouseOverHandler(s.row,s.col)}$tx.stop(e)},i=function(e){t.mouseClickHandler(e)};$tx.observe(this.elTable,"mouseover",e),$tx.observe(this.elTable,"click",i)}}),t.ImageScale=t.Class.create({initialize:function(t,e){if(t.imageurl&&!t.actualwidth){var i=function(i,n){t.actualwidth=i,t.actualheight=n,e&&e(i,n)};setTimeout(function(){var e=new Image;e.onerror=function(){e=_NULL},e.onreadystatechange?e.onreadystatechange=function(){"complete"==this.readyState&&(i(this.width,this.height),e=_NULL)}:e.onload=function(){i(this.width,this.height),e=_NULL},e.src=t.imageurl},10)}}})}(Trex);