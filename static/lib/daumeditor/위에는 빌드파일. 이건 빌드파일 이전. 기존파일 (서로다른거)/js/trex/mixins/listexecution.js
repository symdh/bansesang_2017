Trex.I.ListExecution=Trex.Mixin.create({executeToList:function(e,t,n){this.rngLstNodes=[],this.newGrpNode=function(){var o=e.newNode(t);return e.apply(o,n),o},this.newLstNode=function(){return e.newNode("li")},this.newPrNode=function(){return e.newNode("p")};var o=e.blocks(function(){return"%wrapper,%paragraph"});this._wrapList(e,o),$A(this.rngLstNodes).each(function(t){e.stuffNode(t)})},_wrapList:function(e,t){var n=_NULL,o=this;$A(t).each(function(t){if($tom.kindOf(t,"td,th")){var r=$tom.descendants(t,"%wrapper,%paragraph");if(0==r.length){var i=o.newPrNode();$tom.moveChild(t,i),$tom.append(t,i),r=[i]}o._wrapList(e,r)}else if($tom.kindOf(t,"li")){if(n)$tom.append(n,t);else{n=o.newGrpNode();var a=$tom.parent(t);if($tom.kindOf(a,"ul,ol")){var s=$tom.divideNode(a,$tom.indexOf(t));$tom.insertAt(n,s),$tom.append(n,t),$tom.hasUsefulChildren(a)||$tom.remove(a),$tom.hasUsefulChildren(s)||$tom.remove(s)}else $tom.append(n,t)}o.rngLstNodes.push(t)}else{n||(n=o.newGrpNode(),$tom.insertAt(n,t));var p=o.newLstNode();$tom.kindOf(t,"%wrapper")?$tom.wrap(p,t):$tom.kindOf(t,"%paragraph")?$tom.replace(t,p):$tom.wrap(p,t),$tom.append(n,p),o.rngLstNodes.push(p)}})},executeOffList:function(e){var t=e.blocks(function(){return"%listhead"});$A(t).each(function(t){var n="p";$tom.ancestor(t,"%listgroup")&&(n="li");var o=$tom.children(t,"li");$A(o).each(function(t){$tom.replace(t,e.newNode(n))}),$tom.unwrap(t)})}});