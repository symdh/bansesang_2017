Trex.I.Marker={},Trex.I.Marker.Standard={paste:function(){var e=this.processor.getRange(),r=e.endContainer,t=e.startContainer;9==r.nodeType&&(r=this.processor.doc.body,t=this.processor.doc.body);var s=this.endMarker=this.processor.create("span",{id:"tx_end_marker"}),a=e.endOffset;3==r.nodeType?(r.splitText(a),r.parentNode.insertBefore(s,r.nextSibling)):r.insertBefore(s,r.childNodes[a]);var o=this.startMarker=this.processor.create("span",{id:"tx_start_marker"}),n=e.startOffset;3==t.nodeType?(t.splitText(n),t.parentNode.insertBefore(o,t.nextSibling)):t.insertBefore(o,t.childNodes[n])},remove:function(){$tom.remove(this.startMarker),$tom.remove(this.endMarker)}},Trex.I.Marker.Trident={paste:function(){this.clear();var e=this.processor.getRange(),r=this.processor.doc.body,t=e.duplicate();t.collapse(_TRUE),t.pasteHTML('<span id="tx_start_marker"></span>'),this.startMarker=$tom.collect(r,"#tx_start_marker");var s=e.duplicate();s.collapse(_FALSE),s.pasteHTML('<span id="tx_end_marker"></span>'),this.endMarker=$tom.collect(r,"#tx_end_marker")},clear:function(){var e=this.processor.doc.body;$tom.remove($tom.collect(e,"#tx_start_marker")),$tom.remove($tom.collect(e,"#tx_end_marker"))},remove:function(){$tom.remove(this.startMarker),$tom.remove(this.endMarker)}},Trex.Canvas.Marker=Trex.Class.create({$mixins:[$tx.msie_nonstd?Trex.I.Marker.Trident:Trex.I.Marker.Standard],initialize:function(e){this.processor=e},backup:function(){this.processor.bookmarkWithMarker(this)},checkCollapsed:function(){return $tom.next(this.startMarker)==this.endMarker}});