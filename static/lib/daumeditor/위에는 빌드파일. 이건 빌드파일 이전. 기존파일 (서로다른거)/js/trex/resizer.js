Trex.module("new Trex.Resizer",function(e,t,i,r,s){var n=s.initializedId||"",g=TrexConfig.get("resizer",s),a=_NULL;e.setMinHeight=function(e){return a.setMinHeight(e)},e.restoreMinHeight=function(){return a.restoreMinHeight()},Trex.available(g,"resizer"+n)&&(a=new Trex.Resizer(e,g))}),TrexConfig.add({resizer:{minHeight:200}}),Trex.Resizer=Trex.Class.create({$const:{__Identity:"resizer"},$mixins:[Trex.I.JobObservable],initialize:function(e,t){var i=0;if(e){this.config=t;var r=e.getInitializedId(),s=this.elBar=$tx("tx_resizer"+r);if(s){"5.5"==$tx.msie_ver&&s.setAttribute("align","center"),this.resizeHeightAtService=function(e){"function"==typeof resizeHeight&&resizeHeight(e)},this.resizingHeightAtService=function(e){"function"==typeof resizingEditorHeight&&resizingEditorHeight(e)},this.minDragHeight=t.minHeight;var n;this.startDrag=function(t){var i=e.getCanvas(),r=i.getCurrentPanel();if(r!=_NULL){var s=r.getPosition();if(this.panelHeight=s.height,this.dragStartPosY=t.clientY,this.isDragging=_TRUE,$tx.observe(_DOC,"mousemove",this.documentDraggingHandler),$tx.observe(_DOC,"mouseup",this.stopDragHandler),r.getName()==Trex.Canvas.__WYSIWYG_MODE){if(this.panelTop=s.y,n=r.getDocument(),n==_NULL)return;i.fireJobs("canvas.height.beforechange"),$tx.observe(n,"mousemove",this.wysiwygDraggingHandler),$tx.observe(n,"mouseup",this.stopDragHandler)}$tx.stop(t)}},this.stopDrag=function(t){var r=e.getCanvas(),s=r.getCurrentPanel();s!=_NULL&&(this.isDragging=_FALSE,$tx.stopObserving(_DOC,"mousemove",this.documentDraggingHandler),$tx.stopObserving(_DOC,"mouseup",this.stopDragHandler),n!=_NULL&&($tx.stopObserving(n,"mousemove",this.wysiwygDraggingHandler),$tx.stopObserving(n,"mouseup",this.stopDragHandler),n=_NULL,this.resizeHeightAtService(i),r.fireJobs("canvas.height.afterchange"),$tx.stop(t)))},this.dragingAtDocument=function(t){var r=e.getCanvas();if(this.isDragging){var s=r.getCurrentPanel();if(s==_NULL)return;try{var n=Math.max(this.panelHeight+t.clientY-this.dragStartPosY,this.minDragHeight.parsePx()).toPx();s.setPanelHeight(n),i=n,r.fireJobs("canvas.height.change",n),this.resizingHeightAtService(n)}catch(e){console.log(e)}}$tx.stop(t)},this.dragingAtWysiwyg=function(t){var i=e.getCanvas();if(this.isDragging){var r=i.getCurrentPanel();if(r==_NULL)return;try{var s=_DOC.body.scrollTop||_DOC_EL.scrollTop||_WIN.pageYOffset,n=i.getCanvasPos(),g=Math.max(this.panelHeight+t.clientY+n.y-this.dragStartPosY+this.panelTop-s,this.minDragHeight.parsePx()).toPx();r.setPanelHeight(g),i.fireJobs("canvas.height.change",g)}catch(e){console.log(e)}}$tx.stop(t)},this.startDragHandler=this.startDrag.bindAsEventListener(this),this.stopDragHandler=this.stopDrag.bindAsEventListener(this),this.documentDraggingHandler=this.dragingAtDocument.bindAsEventListener(this),this.wysiwygDraggingHandler=this.dragingAtWysiwyg.bindAsEventListener(this),this.isDragging=_FALSE,$tx.observe(s,"mousedown",this.startDragHandler);var g=e.getCanvas();g.observeJob(Trex.Ev.__CANVAS_FULL_SCREEN_CHANGE,function(){$tx.hide(s)}),g.observeJob(Trex.Ev.__CANVAS_NORMAL_SCREEN_CHANGE,function(){$tx.show(s)})}}},setMinHeight:function(e){return this.minDragHeight=e.toPx()},restoreMinHeight:function(){return this.minDragHeight=this.config.minHeight||200}});